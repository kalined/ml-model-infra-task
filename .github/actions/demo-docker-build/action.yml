name: Docker Build Composite Action
description: Set up Docker Buildx, extract metadata, and build

inputs:
  docker_username:
    description: 'Docker Username'
    required: true
  docker_token:
    description: "Docker Token"
    required: true
  docker_image_name:
    description: 'Docker Image Name'
    required: true
  docker_image_tag:
    description: 'Docker Image Tag'
    required: true

runs:
  using: "composite"
  steps:

    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v3
      with:
        driver: docker
    
    - name: Login to DockerHub
      if: github.event_name != 'pull_request'
      uses: docker/login-action@v3
      with:
        username: ${{ inputs.docker_username }}
        password: ${{ inputs.docker_token }}

    - name: Build and push
      uses: docker/build-push-action@v6
      with:
        context: .
        push: true
        tags: ${{ inputs.docker_image_name }}:${{ inputs.docker_image_tag }}